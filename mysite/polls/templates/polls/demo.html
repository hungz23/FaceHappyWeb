<!-- <video autoplay></video>

<script>
  var errorCallback = function(e) {
    console.log('Reeeejected!', e);
  };

  // Not showing vendor prefixes.
  navigator.getUserMedia({video: true, audio: true}, function(localMediaStream) {
    var video = document.querySelector('video');
    video.src = window.URL.createObjectURL(localMediaStream);

    // Note: onloadedmetadata doesn't fire in Chrome when using it with getUserMedia.
    // See crbug.com/110938.
    video.onloadedmetadata = function(e) {
      // Ready to go. Do some stuff.
    };
  }, errorCallback);
</script>
 -->
 {# Load the tag library #}
 {% load bootstrap3 %}

 {# Load CSS and JavaScript #}
 {% bootstrap_css %}
 {% bootstrap_javascript %}

 {# Display django.contrib.messages as Bootstrap alerts #}
 {% bootstrap_messages %}


<form action="{% url 'polls:demo' %}" method="post">
{% csrf_token %}

<video width="300" height="150" autoplay></video>
<img src="" name="myimage">
<input type="hidden" name="image">
{% if email %}
  <input  name="email" placeholder="email"  required="required" value={{email}}>
{% else%}
  <input type="text" name="email" placeholder="email"  required="required">
{% endif %}
<canvas style="display:none;" width="300" height="150"></canvas>

<script>


  var errorCallback = function(e) {
    console.log('Reeeejected!', e);
  };
  var video = document.querySelector('video');
  var canvas = document.querySelector('canvas');
  var ctx = canvas.getContext('2d');
  var localMediaStream = null;
  var image = new Image();


  function snapshot() {
    if (localMediaStream) {
      ctx.drawImage(video,0, 0, 300, 150);
      // "image/webp" works in Chrome.
      // Other browsers will fall back to image/png.
      image.src = canvas.toDataURL('image/png');
      document.querySelector('input[name="image"]').value = canvas.toDataURL('image/png');
      document.querySelector('img').src = canvas.toDataURL('image/png');
    }
  }
  video.addEventListener("click", snapshot, true);



  // Not showing vendor prefixes or code that works cross-browser.
  navigator.getUserMedia({video: true}, function(stream) {
    video.src = window.URL.createObjectURL(stream);
    localMediaStream = stream;
  }, errorCallback);
</script>
<!-- <input type="submit" value="Submit" /> -->
<button type="submit" class="btn btn-primary">Submit</button>
</form>
